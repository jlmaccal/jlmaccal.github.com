<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>zam.cluster</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="zam-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="zam-module.html">Package&nbsp;zam</a> ::
        Module&nbsp;cluster
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="zam.cluster-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module cluster</h1><p class="nomargin-top"><span class="codelink"><a href="zam.cluster-pysrc.html">source&nbsp;code</a></span></p>
<p>Routines to perform RMSD clustering on a trajectory.</p>
  <p>Main routine is Cluster().</p>

<!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Functions</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Functions"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">tuple of (list of array, list of int, list of float)</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="zam.cluster-module.html#Cluster" class="summary-sig-name">Cluster</a>(<span class="summary-sig-arg">CoordsObj</span>,
        <span class="summary-sig-arg">Cutoff</span>=<span class="summary-sig-default">2.</span>,
        <span class="summary-sig-arg">MaxCluster</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">Linkage</span>=<span class="summary-sig-default">&quot;average&quot;</span>)</span><br />
      Clusters conformations in a trajectory based on RMSD distance.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="zam.cluster-pysrc.html#Cluster">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_TakeTopClusters"></a><span class="summary-sig-name">_TakeTopClusters</span>(<span class="summary-sig-arg">ClustNums</span>,
        <span class="summary-sig-arg">NClusters</span>)</span><br />
      Take a list of clusters for each frame and take only the top 
      NClusters, with the rest being set to no cluster (-1)</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="zam.cluster-pysrc.html#_TakeTopClusters">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_SortClusters"></a><span class="summary-sig-name">_SortClusters</span>(<span class="summary-sig-arg">ClustNums</span>,
        <span class="summary-sig-arg">Populations</span>)</span><br />
      Sort clusters by population</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="zam.cluster-pysrc.html#_SortClusters">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_CalcClustStructures"></a><span class="summary-sig-name">_CalcClustStructures</span>(<span class="summary-sig-arg">Frames</span>,
        <span class="summary-sig-arg">FramesNoMask</span>,
        <span class="summary-sig-arg">ClustNums</span>)</span><br />
      Calculate the most representative structure for each cluster.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="zam.cluster-pysrc.html#_CalcClustStructures">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_GetClustFrames"></a><span class="summary-sig-name">_GetClustFrames</span>(<span class="summary-sig-arg">ClustNums</span>)</span><br />
      Get a list of frames for each cluster.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="zam.cluster-pysrc.html#_GetClustFrames">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_CalcCentroids"></a><span class="summary-sig-name">_CalcCentroids</span>(<span class="summary-sig-arg">Frames</span>,
        <span class="summary-sig-arg">ClustNums</span>)</span><br />
      Calculate the centroid for each cluster given a trajectory and list 
      of cluster assignments.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="zam.cluster-pysrc.html#_CalcCentroids">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_GetPopulations"></a><span class="summary-sig-name">_GetPopulations</span>(<span class="summary-sig-arg">ClustNum</span>)</span><br />
      Get cluster populations from a list of cluster assignments for 
      frames.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="zam.cluster-pysrc.html#_GetPopulations">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_GetNClusters"></a><span class="summary-sig-name">_GetNClusters</span>(<span class="summary-sig-arg">Tree</span>,
        <span class="summary-sig-arg">NFrames</span>,
        <span class="summary-sig-arg">Cutoff</span>)</span><br />
      Get the number of clusters with a linkage distance greater than 
      Cutoff.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="zam.cluster-pysrc.html#_GetNClusters">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_BuildRmsdMatrix"></a><span class="summary-sig-name">_BuildRmsdMatrix</span>(<span class="summary-sig-arg">Frames</span>)</span><br />
      Build an RMSD matrix from a list of frames</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="zam.cluster-pysrc.html#_BuildRmsdMatrix">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="SaveClustResults"></a><span class="summary-sig-name">SaveClustResults</span>(<span class="summary-sig-arg">Pos</span>,
        <span class="summary-sig-arg">ClustNum</span>,
        <span class="summary-sig-arg">ClustPop</span>,
        <span class="summary-sig-arg">ConfIndices</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">Prefix</span>=<span class="summary-sig-default">&quot;clust&quot;</span>)</span><br />
      Save cluster results to file.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="zam.cluster-pysrc.html#SaveClustResults">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== VARIABLES ==================== -->
<a name="section-Variables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Variables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="Logger"></a><span class="summary-name">Logger</span> = <code title="zam.utility.SetupLogging(__name__)">zam.utility.SetupLogging(__name__)</code>
    </td>
  </tr>
</table>
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Function Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-FunctionDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="Cluster"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">Cluster</span>(<span class="sig-arg">CoordsObj</span>,
        <span class="sig-arg">Cutoff</span>=<span class="sig-default">2.</span>,
        <span class="sig-arg">MaxCluster</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">Linkage</span>=<span class="sig-default">&quot;average&quot;</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="zam.cluster-pysrc.html#Cluster">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Clusters conformations in a trajectory based on RMSD distance.</p>
  <p>This function performs hierarchical clustering in cartesian space. 
  This module first calculates the RMSD matrix for all frames in the 
  trajectory, which can be very slow and scales as N^2. Once this is done, 
  it uses pycluster to perform the clustering. Complete linkage is used, 
  meaning that all structures within a cluster will be within Cutoff of 
  each other, unless MaxCluster is specified, in which case they may be 
  farther apart than that as more distant clusters will be merged until we 
  reach MaxCluster clusters. The structure of each cluster is the frame 
  closest to the centroid of the cluster.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>CoordsObj</code></strong> (<a href="zam.coords.TrjClass-class.html" 
          class="link">coord.TrjClass</a>) - trajectory to cluster</li>
        <li><strong class="pname"><code>Cutoff</code></strong> (float) - maximum RMSD distance of a configuration to a cluster</li>
        <li><strong class="pname"><code>MaxCluster</code></strong> (int) - maximum number of clusters; default of none gives no upper bound 
          on the number of clusters</li>
    </ul></dd>
    <dt>Returns: tuple of (list of array, list of int, list of float)</dt>
        <dd>a tuple(Pos, ClustNum, ClustPop), where Pos is a list of 
          structures of each cluster. ClustNum is a list of clusters with 
          one for each frame. ClustPop is a list containing the population 
          of each cluster.</dd>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="zam-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Thu Jul 23 17:42:21 2009
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
